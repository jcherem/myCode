kernel ParticleMotionKernel : ImageComputationKernel<ePixelWise>
{
    Image<eReadWrite> p_position;
    Image<eRead> p_velocity;
    Image<eRead> p_age;
    Image<eRead> p_life;

    param:
        float _timeStep;

    void define() {
        defineParam(_timeStep, "Time Step", 0.1f);
    }

    void process() {
        float2 position = p_position();
        float2 velocity = p_velocity();
        float age = p_age();
        float life = p_life();

        // Calculate the new position based on the velocity and the time step
        float2 newPosition = position + velocity * _timeStep;

        // Update the position of the particle
        p_position() = newPosition;
    }
};
